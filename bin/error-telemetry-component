#!/usr/bin/env ruby

require_relative '../init'

require 'process_host'

dispatcher = ErrorTelemetryComponent::Dispatcher.build
command_subscription = EventStore::Messaging::Subscription.build '$ce-error:command', dispatcher
event_subscription = EventStore::Messaging::Subscription.build '$ce-error', dispatcher

cooperation = ProcessHost::Cooperation.build

cooperation.register command_subscription, 'command-handlers'
cooperation.register event_subscription, 'event-handlers'

cooperation.start!
